{% load stock_filters %}
{% load custom_filters %}

<html>
  <head>
   
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <style>
      body {
        font-family: "Roboto", sans-serif;
      }
    </style>
  </head>
  <body class="container bg-gray-900 text-white">
    <div class="p-4">
  
      <div class="mb-4">
        <h1 class="text-2xl font-bold">Portfolio</h1>
        <div class="flex space-x-4 mt-2">
          <div class="flex items-center space-x-1">
            <span class="text-blue-500">Holdings</span>
            <span class="bg-blue-500 text-white rounded-full px-2">3</span>
          </div>
        </div>
      </div>
      <div class="bg-gray-800 p-4 rounded-lg mb-4">
        <div class="flex justify-between mb-2">
          <div>
            <span class="text-gray-400 text-sm">Invested</span>
            <div class="text-xl font-semibold"> {{Invested_amount}} </div>
          </div>
          <div>
            <span class="text-gray-400 text-sm">Current</span>
            <div class="text-xl font-semibold">7,884.42</div>
          </div>
        </div>
        <div class="flex justify-between items-center">
          <div>
            <span class="text-gray-400 text-sm">P&L</span>
            <div class="text-red-500 text-xl font-semibold">-1,132.37</div>
          </div>
          <div class="bg-red-500 text-white rounded-full px-2 py-1 text-sm">
            -12.56%
          </div>
        </div>
      </div>
  
      
      
      {% for stock  in holdingStock %}
      <div class="bg-gray-800 p-4 rounded-lg mb-4">
        <div class="flex justify-between items-center mb-2">
          <div class="text-sm text-gray-400">Qty. {{stock.quantity}} â€¢ Avg. {{stock.average_price}} </div>
          
          {% calculate_percentage stock.current_price stock.average_price as percentage_change %}
<div class="text-sm {% if percentage_change >= 0 %}text-green-500{% else %}text-red-500{% endif %}">
    {{ percentage_change }}%
</div>
        </div>
        <div class="flex justify-between items-center mb-2">
          <div class="text-lg font-semibold"> {{stock.stock.name}} </div>
          
          {% calculate_profit_or_loss stock.current_price stock.average_price stock.quantity as PandL %}
          <div class="{% if PandL >= 0 %}text-green-500{% else %}text-red-500{% endif %} text-lg font-semibold">  {{ PandL|flot }}

      



          </div>
        </div>
        <div class="flex justify-between items-center">
          <div class="text-sm text-gray-400">Invested {{stock.inversted_amount}} </div>
          {%  get_stock_price_difference stock.stock.yfinance_name as stock_diff %}
          <div class="text-sm text-gray-400">
            
            LTP {{stock.current_price}} <span class="text-green-500 {% if stock_diff >= 0 %}text-green-500{% else %}text-red-500{% endif %}">( {{stock_diff}} %)</span>
          </div>
        </div>
      </div>
       
      {% endfor %}
        
  
      <div class="bg-gray-800 p-4 rounded-lg">
        <div class="flex justify-between items-center">
          <div class="text-sm text-gray-400">Day's P&L</div>
          <div class="text-red-500 text-lg font-semibold">-145.73</div>
          <div class="text-red-500 text-lg font-semibold">-1.81%</div>
        </div>
      </div>
    </div>
    <div
      class="fixed bottom-0 left-0 right-0 bg-gray-800 p-4 flex justify-around items-center"
    >
      <div class="flex flex-col items-center">
        <i class="fas fa-bookmark text-white"></i>
        <span class="text-sm text-white">Watchlist</span>
      </div>
      <div class="flex flex-col items-center">
        <i class="fas fa-file-alt text-white"></i>
        <span class="text-sm text-white">Orders</span>
      </div>
      <div class="flex flex-col items-center">
        <i class="fas fa-briefcase text-blue-500"></i>
        <span class="text-sm text-blue-500">holdings</span>
      </div>
      <div class="flex flex-col items-center">
        <i class="fas fa-gavel text-white"></i>
        <span class="text-sm text-white">demo account </span>
      </div>
      <div class="flex flex-col items-center">
        <i class="fas fa-user text-white"></i>
        <span class="text-sm text-white"> user id</span>
      </div>
    </div>
  </body>
</html>
